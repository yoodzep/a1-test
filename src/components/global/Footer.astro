---
// Assets
import Logo from "@/components/assets/Logo.astro";
// Fundations
import Text from "@/components/fundations/elements/Text.astro";
import Button from "@/components/fundations/elements/Button.astro";
import Wrapper from "@/components/fundations/containers/Wrapper.astro";
// Content
import { getCollection } from "astro:content";

type LinkItem = {
  label: string;
  href: string;
};

type LinkSection = {
  title: string;
  links: LinkItem[];
};

const services = (await getCollection("services"))
  .sort((a, b) => a.data.title.localeCompare(b.data.title))
  .slice(0, 8);

const linkSections: LinkSection[] = [
  {
    title: "Company",
    links: [
      { label: "About", href: "/about" },
      { label: "FAQs", href: "/faqs" },
      { label: "Careers", href: "/careers" },
      { label: "Contact", href: "/contact" },
    ],
  },
  {
    title: "Services",
    links: services.map((service) => ({
      label: service.data.title,
      href: `/services/${service.slug}`,
    })),
  },
  {
    title: "Resources",
    links: [
      { label: "Blog", href: "/blog" },
      { label: "Finance Options", href: "/finance" },
      { label: "Privacy Policy", href: "/legal/privacy" },
      { label: "Terms & Conditions", href: "/legal/terms" },
    ],
  },
];

const contactDetails = {
  email: "admin@a1electrical.co.nz",
  phone: "021 453 193",
  afterHours: "03 453 0415",
  address: "405 Kaikorai Valley Road\nDunedin 9011",
  hours: ["Monday - Friday: 7:30 AM - 5:00 PM"],
};

const legalLinks: LinkItem[] = [
  { label: "Privacy Policy", href: "/legal/privacy" },
  { label: "Terms & Conditions", href: "/legal/terms" },
];

const certifications = [
  "Master Electricians",
  "ECANZ",
  "SafePower",
  "BNI",
  "SuperGold Card Accepted",
];
---

<footer class="relative isolate overflow-hidden bg-accent-950 text-base-100">
  <div class="absolute inset-0 z-0 pointer-events-none bg-accent-950"></div>

  <Wrapper
    variant="standard"
    class="relative z-10 lg:border-white/15 py-8 border-b lg:border-x"
  >
    <div
      class="flex flex-col gap-8 p-8 lg:flex-row lg:items-end lg:justify-between bg-accent-950 rounded"
    >
      <div class="max-w-xl text-balance">
        <Logo class="h-16" />

        <Text tag="p" variant="textLG" class="text-white font-medium mt-12">
          Your trusted Master Electricians in Dunedin. Locally owned, professionally certified, community proud.
        </Text>

        <div class="flex flex-wrap gap-2 mt-6">
          {certifications.map((cert) => (
            <span class="text-xs bg-white/10 text-base-300 px-3 py-1 rounded-full">
              {cert}
            </span>
          ))}
        </div>
      </div>
      <div class="flex flex-wrap gap-2 sm:items-center">
        <Button
          isLink
          size="xs"
          variant="default"
          href={`mailto:${contactDetails.email}`}
        >
          {contactDetails.email}
        </Button>
        <Button
          isLink
          size="xs"
          variant="muted"
          href={`tel:${contactDetails.phone.replace(/\s/g, "")}`}
        >
          {contactDetails.phone}
        </Button>
      </div>
    </div>
  </Wrapper>
  <Wrapper
    variant="standard"
    class="relative py-8 lg:border-x lg:border-white/15 space-y-12 z-10"
  >
    <div class="grid gap-x-8 sm:grid-cols-2 lg:grid-cols-4 gap-y-24">
      {
        linkSections.map((section) => (
          <div>
            <Text
              tag="p"
              variant="textXS"
              class="uppercase font-medium text-white"
            >
              {section.title}
            </Text>
            <div class="space-y-2 text-sm mt-12">
              {section.links.map((link) => (
                <a
                  href={link.href}
                  class="block text-base-200 transition hover:text-accent-300 w-fit"
                >
                  {link.label}
                </a>
              ))}
            </div>
          </div>
        ))
      }

      <div>
        <Text tag="p" variant="textXS" class="uppercase font-medium text-white">
          Contact
        </Text>
        <div class="mt-12 space-y-4">
          <div>
            <Text tag="p" variant="textSM" class="text-base-200">
              {contactDetails.hours[0]}
            </Text>
          </div>
          <div>
            <Text tag="p" variant="textSM" class="text-base-400">Phone</Text>
            <a href={`tel:${contactDetails.phone.replace(/\s/g, "")}`} class="text-base-200 hover:text-accent-300 transition">
              {contactDetails.phone}
            </a>
          </div>
          <div>
            <Text tag="p" variant="textSM" class="text-base-400">After Hours</Text>
            <a href={`tel:${contactDetails.afterHours.replace(/\s/g, "")}`} class="text-base-200 hover:text-accent-300 transition">
              {contactDetails.afterHours}
            </a>
          </div>
          <address class="not-italic">
            <Text tag="p" variant="textSM" class="text-base-400">Address</Text>
            <p class="whitespace-pre-line leading-relaxed text-base-200">
              {contactDetails.address}
            </p>
          </address>
        </div>
      </div>
    </div>

    <div class="border-t border-white/10 pt-8">
      <div
        class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between"
      >
        <Text tag="p" variant="textSM" class="text-base-300">
          &copy; {new Date().getFullYear()} A1 Electrical Constructions. All rights reserved.
        </Text>
        <div class="flex flex-wrap gap-4 text-white text-sm">
          {
            legalLinks.map((link) => (
              <a href={link.href} class="hover:text-accent-300 transition">
                {link.label}
              </a>
            ))
          }
          <a
            href="https://www.facebook.com/A1ElectricalConstructionsDunedin"
            target="_blank"
            rel="noopener noreferrer"
            class="hover:text-accent-300 transition"
          >
            Facebook
          </a>
        </div>
      </div>
    </div>
  </Wrapper>
</footer>
