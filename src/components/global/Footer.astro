---
// Assets
import Logo from "@/components/assets/Logo.astro";
// Fundations
import Text from "@/components/fundations/elements/Text.astro";
import Button from "@/components/fundations/elements/Button.astro";
import Wrapper from "@/components/fundations/containers/Wrapper.astro";
// Content
import { getCollection } from "astro:content";

type LinkItem = {
  label: string;
  href: string;
};

type LinkSection = {
  title: string;
  links: LinkItem[];
};

const services = (await getCollection("services"))
  .sort((a, b) => a.data.title.localeCompare(b.data.title))
  .slice(0, 6);

const linkSections: LinkSection[] = [
  {
    title: "Company",
    links: [
      { label: "About", href: "/about" },
      { label: "Why Us", href: "/why-us" },
      { label: "Partners", href: "/partners" },
      { label: "Mission", href: "/mission" },
    ],
  },
  {
    title: "Services",
    links: services.map((service) => ({
      label: service.data.title,
      href: `/services/${service.slug}`,
    })),
  },
  {
    title: "Resources",
    links: [
      { label: "Projects", href: "/projects" },
      { label: "Blog", href: "/blog" },
      { label: "Careers", href: "/careers" },
      { label: "Team", href: "/team" },
      { label: "Privacy", href: "/legal/privacy" },
    ],
  },
];

const contactDetails = {
  email: "hello@bastion.com",
  phone: "+1 (555) 123-4567",
  address: "123 Market Street, Suite 500\nSan Francisco, CA 94103",
  hours: ["Mon-Fri: 8:00 AM - 6:00 PM", "Sat-Sun: By appointment"],
};

const legalLinks: LinkItem[] = [
  { label: "Privacy", href: "/legal/privacy" },
  { label: "Terms", href: "/legal/terms" },
  { label: "Cookies", href: "/legal/cookies" },
];
---

<footer class="relative isolate overflow-hidden bg-accent-950 text-base-100">
  <div class="absolute inset-0 z-0 pointer-events-none">
    <video autoplay muted loop playsinline class="size-full object-cover">
      <source src="/night.mp4" type="video/mp4" />
    </video>
    <div class="absolute inset-0 bg-accent-950/75"></div>
  </div>

  <Wrapper
    variant="standard"
    class="relative z-10 lg:border-white/15 py-8 border-b lg:border-x"
  >
    <div
      class="flex flex-col gap-8 p-8 lg:flex-row lg:items-end lg:justify-between bg-accent-950 rounded"
    >
      <div class="max-w-xl text-balance">
        <Logo class="h-12 text-white" />

        <Text tag="p" variant="textLG" class="text-white font-medium mt-24">
          Building with precision, dependable delivery, and clear communication
          from preconstruction through handover.
        </Text>
      </div>
      <div class="flex flex-wrap gap-2 sm:items-center">
        <Button
          isLink
          size="xs"
          variant="default"
          href={`mailto:${contactDetails.email}`}
        >
          {contactDetails.email}
        </Button>
        <Button
          isLink
          size="xs"
          variant="muted"
          href={`tel:${contactDetails.phone.replace(/[^\d+]/g, "")}`}
        >
          {contactDetails.phone}
        </Button>
      </div>
    </div>
  </Wrapper>
  <Wrapper
    variant="standard"
    class="relative py-8 lg:border-x lg:border-white/15 space-y-12 z-10"
  >
    <div class="grid gap-x-8 sm:grid-cols-2 lg:grid-cols-4 gap-y-24">
      {
        linkSections.map((section) => (
          <div>
            <Text
              tag="p"
              variant="textXS"
              class="uppercase font-medium  text-white"
            >
              {section.title}
            </Text>
            <div class="space-y-2 text-sm mt-12">
              {section.links.map((link) => (
                <a
                  href={link.href}
                  class="block text-base-200 transition hover:text-accent-300 w-fit"
                >
                  {link.label}
                </a>
              ))}
            </div>
          </div>
        ))
      }

      <div>
        <Text tag="p" variant="textXS" class="uppercase font-medium text-white">
          Contact
        </Text>
        <div class="mt-12">
          <Text tag="p" variant="textSM" class="text-base-200"
            >{contactDetails.hours[0]}</Text
          >
          <Text tag="p" variant="textSM" class="text-base-200"
            >{contactDetails.hours[1]}</Text
          >
          <address>
            <p class="whitespace-pre-line leading-relaxed mt-2">
              {contactDetails.address}
            </p>
          </address>
        </div>
      </div>
    </div>

    <div class="border-t border-white/10 pt-8">
      <div
        class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between"
      >
        <Text tag="p" variant="textSM" class="text-base-300">
          Â© {new Date().getFullYear()} Bastion. All rights reserved.
        </Text>
        <div class="flex flex-wrap gap-4 text-white text-sm">
          {
            legalLinks.map((link) => (
              <a href={link.href} class="hover:text-accent-300 transition">
                {link.label}
              </a>
            ))
          }
        </div>
      </div>
    </div>
  </Wrapper>
</footer>
